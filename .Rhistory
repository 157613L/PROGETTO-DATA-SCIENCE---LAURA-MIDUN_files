xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy")
us_imp <- filter(tab1, Partner.Name == "United States")
us_imp %>%
ggplot(aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line() +
xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy")
us_imp_lt <- lm((as.numeric(sub(",", ".", Import, fixed = TRUE))) ~ (as.numeric(Year)), data = us_imp)
us_imp %>%
add_predictions(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), pred)) +
geom_line() +
xlab("Year") +
ggtitle("Linear trend")
library(modelr)
us_imp_lt <- lm((as.numeric(sub(",", ".", Import, fixed = TRUE))) ~ (as.numeric(Year)), data = us_imp)
us_imp %>%
add_predictions(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), pred)) +
geom_line() +
xlab("Year") +
ggtitle("Linear trend")
library(modelr)
us_imp %>%
add_residuals(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), resid)) +
geom_hline(yintercept = 0, colour = "white", size = 3) +
geom_line() +
xlab("Year") +
ylab("Resid") +
ggtitle("Remaining pattern")
ggplot(us_imp, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red")
library(ggplot2)                 #NON FUNZIONA!!!!
ggplot(us_imp, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
library(ggplot2)                 #NON FUNZIONA!!!!
ggplot(us_imp_lt, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
by_country <- tab1 %>%
group_by(Partner.Name) %>%
nest()                          #nest() --> ogni riga contiene un dataframe
country_model <- function(df) {
lm((as.numeric(sub(",", ".", Import, fixed = TRUE))) ~ (as.numeric(Year)), data = df)
}
View(country_model)
library(purrr)
by_country <- by_country %>%
mutate(model = map(data, country_model))
by_country
View(by_country)
library(purrr)
by_country <- by_country %>%
mutate(data = map2(data, model, add_residuals))
library(purrr)
by_country <- by_country %>%
mutate(data = map2(data, model, add_residuals))
by_country
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic()
(resids = unnest(by_country, data))
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = )
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = "2 years")   #NON VA
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = "10 years")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = 10)
us_imp <- filter(tab1, Partner.Name == "United States")
us_imp %>%
ggplot(aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line() +
xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy")
us_imp <- filter(tab1, Partner.Name == "United States")
us_imp %>%
ggplot(aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line() +
xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy") +
scale_x_continuous(limits = c(1994, 2019))
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = c(1994, 2000, 2010, 2019))   #NON VA
library(ggplot2)
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = c(1994, 2000, 2010, 2019))
us_imp <- filter(tab1, Partner.Name == "United States")
us_imp %>%
ggplot(aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line() +
xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy")
tab1 <- select(import, Reporter.Name, Partner.Name, Product.Group, (X1994 : X2019))
#pivot_longer --> da colonne a righe
tab1 <- pivot_longer( tab1,
c('X1994':'X2019'),
names_prefix = "X",
names_to = "Year",
values_to = "Import"
)
#rappresentazione delle importazioni da tutti i paesi presi in considerazione all'italia
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019") +
#scale_y_continuous(breaks = )
tab1 <- select(import, Reporter.Name, Partner.Name, Product.Group, (X1994 : X2019))
#pivot_longer --> da colonne a righe
tab1 <- pivot_longer( tab1,
c('X1994':'X2019'),
names_prefix = "X",
names_to = "Year",
values_to = "Import"
)
#rappresentazione delle importazioni da tutti i paesi presi in considerazione all'italia
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
set.seed(0)
data <- data.frame(y = c(1:4))
head(data)
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
set.seed(0)
data <- data.frame(y = c(1:4))
head(data)
tab1 <- select(import, Reporter.Name, Partner.Name, Product.Group, (X1994 : X2019))
#pivot_longer --> da colonne a righe
tab1 <- pivot_longer( tab1,
c('X1994':'X2019'),
names_prefix = "X",
names_to = "Year",
values_to = "Import"
)
#rappresentazione delle importazioni da tutti i paesi presi in considerazione all'italia
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
us_imp <- filter(tab1, Partner.Name == "United States")
us_imp %>%
ggplot(aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line() +
xlab("Year") +
ylab("Import") +
ggtitle("USA - Italy")
us_imp_lt <- lm((as.numeric(sub(",", ".", Import, fixed = TRUE))) ~ (as.numeric(Year)), data = us_imp)
us_imp %>%
add_predictions(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), pred)) +
geom_line() +
xlab("Year") +
ggtitle("Linear trend")
us_imp %>%
add_residuals(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), resid)) +
geom_hline(yintercept = 0, colour = "white", size = 3) +
geom_line() +
xlab("Year") +
ylab("Resid") +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern") +     #???
scale_x_continuous(breaks = c(1994, 2000, 2010, 2019))   #NON VA
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("") +     #non so che nome mettere
ggtitle()
tab1 <- select(import, Reporter.Name, Partner.Name, Product.Group, (X1994 : X2019))
#pivot_longer --> da colonne a righe
tab1 <- pivot_longer( tab1,
c('X1994':'X2019'),
names_prefix = "X",
names_to = "Year",
values_to = "Import"
)
#rappresentazione delle importazioni da tutti i paesi presi in considerazione all'italia
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
#rappresentazione delle importazioni da tutti i paesi presi in considerazione all'italia
tab1 <- data[data$y != "0.0e+00", ]
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
tab1 <- data[tab1$y != "0.0e+00", ]
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
tab1 <- tab1[tab1$y != "0.0e+00", ]
tab1 <- tab1[data$y != "0.0e+00", ]
tab1 <- tab1[data$y != "2.5e+07", ]
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
tab1 <- tab1[data$y = "0", ]
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
data <- tab1(y = c(1:4))
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
tab1 <- tab1(y = c(1:4))
ggplot(tab1, aes(x = as.numeric(Year), y = as.numeric(sub(",", ".", Import, fixed = TRUE)))) +
geom_line(aes(group = Partner.Name), alpha = 1/2) +
theme_classic() +
xlab("Year") +
ylab("Import") +
ggtitle("Import (US$ thousand) 1994-2019")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE, method = "loess") +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(y ~ x, se = FALSE, method = "loess") +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(resid ~ Year, se = FALSE, method = "loess") +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")      #???
resids %>%
ggplot(aes(Year, resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth("resid" ~ "Year", se = FALSE, method = "loess") +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes((as.numeric(Year)), resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE, method = "loess") +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
resids %>%
ggplot(aes((as.numeric(Year)), resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE) +         #non esce la riga colorata
theme_classic() +
ggtitle("Remaining pattern")
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("") +     #non so che nome mettere
ggtitle()
resids %>%
ggplot(aes((as.numeric(Year)), resid)) +
geom_line(aes(group = Partner.Name), alpha = 1 / 3) +
geom_smooth(se = FALSE, color = "red") +
theme_classic() +
ggtitle("Remaining pattern")
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so che nome mettere
ggtitle()
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
scale_x_continuous(label = "Year") + #NON VA!!!
scale_y_continuous(label = "Import") +     #non so che nome mettere
ggtitle()      #non so che nome mettere
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so che nome mettere
legend(legend = c("Valori effettivi", "residui"), title = "Legenda", fill = colors("blue", "red"))
ggtitle()
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so che nome mettere
legend(legend = c("Valori effettivi", "residui"), title = "Legenda", col = (2, 3)) +
ggtitle()
install.packages("graphics")
library(graphics)
#comparo il grafico iniziale con quello dei residui
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so che nome mettere
legend(legend = c("Valori effettivi", "Residui"), title = "Legenda", col = (2 : 3)) +
ggtitle()      #non so che nome mettere
#comparo il grafico iniziale con quello dei residui
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so che nome mettere
legend(legend = c("Valori effettivi", "Residui"), title = "Legenda", col = (2)) +
ggtitle()
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
# xlab("Year") + #NON VA!!!
#ylab("Import") +     #non so che nome mettere
legend(legend = c("Valori effettivi", "Residui"), title = "Legenda", col = (2)) +
ggtitle()      #non so che nome mettere
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("Import") +     #non so se è giusto il nome
legend(x = "topright",
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()      #non so che nome mettere
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
#xlab("Year") + #NON VA!!!
#ylab("Import") +     #non so se è giusto il nome
legend(x = "topright",
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
#xlab("Year") + #NON VA!!!
#ylab("Import") +     #non so se è giusto il nome
legend(x = "topright",
lwd = 1,
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()      #non so che nome mettere
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
#xlab("Year") + #NON VA!!!
#ylab("Import") +     #non so se è giusto il nome
legend(x = "topright",
lty = c(1:1)
lwd = 1,
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()
#comparo il grafico iniziale con quello dei residui
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
#xlab("Year") + #NON VA!!!
#ylab("Import") +     #non so se è giusto il nome
legend(x = "topright",
lty = c(1:1),
lwd = 1,
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()
us_imp_lt <- lm((as.numeric(sub(",", ".", Import, fixed = TRUE))) ~ (as.numeric(Year)), data = us_imp)
us_imp %>%
add_predictions(us_imp_lt) %>%
ggplot(aes((as.numeric(Year)), pred)) +
geom_line() +
xlab("Year") +
ggtitle("Linear trend") #cambia formato asse y
#comparo il grafico iniziale con quello dei residui
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("Year") + #NON VA!!!
ylab("") +     #non so se è giusto il nome
legend(x = "topright",
lty = c(1:1),
lwd = 1,
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()      #non so che nome mettere
#comparo il grafico iniziale con quello dei residui
ggplot(resids, aes((as.numeric(Year)))) + # basic graphical object
geom_line(aes(y = (as.numeric(sub(",", ".", Import, fixed = TRUE)))), colour="blue") + # first layer
geom_line(aes(y = resid), colour="red") # second layer
xlab("1") + #NON VA!!!
ylab("2") +     #non so se è giusto il nome
legend(x = "topright",
lty = c(1:1),
lwd = 1,
legend = c("Valori effettivi", "Residui"),
title = "Legenda",
col = c("blue","red")) +
ggtitle()      #non so che nome mettere
